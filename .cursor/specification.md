# 일본어 단어장 (japan_wordbook.html) 명세서

## 개요
일본어 단어 학습을 위한 웹 애플리케이션입니다. 플래시카드 방식의 평가 모드와 테이블 방식의 공부 모드를 제공하며, 가중치 기반 반복 학습 시스템을 구현하고 있습니다.

## 기술 스택
- **HTML5**: 단일 파일 구조
- **CSS3**: 반응형 디자인 (모바일 최적화)
- **JavaScript (Vanilla)**: 클라이언트 사이드 로직
- **세션 기반**: 페이지 새로고침 시 모든 데이터 초기화

## 파일 구조
```
index.html (메인 HTML 파일)
├── <head>
│   ├── 메타 태그 (UTF-8, viewport)
│   └── <style> - 인라인 CSS
├── <body>
│   ├── HTML 구조
│   └── <script> - JavaScript 로직
│       ├── 동적 데이터 로드 (results/ 폴더의 JSON 파일들)
│       ├── 평가하기 모드 로직
│       ├── 공부하기 모드 로직
│       └── 발음 재생 및 텍스트 보임/숨김 기능
```

## 주요 화면 구성

### 1. 파일 선택 화면 (`fileSelectionScreen`)
- **모드 선택**: 평가하기 / 공부하기
- **문제 유형 선택** (평가하기 모드만 표시): 일본어 표기 문제, 의미 문제 체크박스 (기본값: 둘 다 선택)
- **파일 업로드**: JSON 파일 다중 업로드
- **단어묶음 목록**: 체크박스로 선택
- **전체선택/전체해제** 버튼
- **학습 시작** 버튼

### 2. 플래시카드 화면 (`flashcardScreen`)
- **평가하기 모드 전용**
- 카드 형태의 단어 표시
- **진행도 배지** (좌측 상단): "진행도: A / B" 형태 (A = 가중치가 0이 된 문제 수, B = 전체 문제 수)
- **가중치 배지** (우측 상단): 현재 문제의 가중치 표시
- 이전/다음 네비게이션
- 정답 확인 기능
- **발음 듣기 버튼**: 답 공개 후 발음 항목 옆에 듣기 버튼(▶) 표시 (공부하기 모드와 동일한 스타일)
- **답 항목 순서**: 일본어 표기 → 뜻 → 발음 (발음이 가장 아래)
- **완료 시 자동 이동**: 모든 문제 완료 시 알람 없이 바로 처음 화면으로 이동

### 3. 공부하기 테이블 화면 (`studyTableScreen`)
- **공부하기 모드 전용**
- 테이블 형태로 모든 단어 표시
- ID, 재생, 일본어 표기, 발음, 의미 컬럼
- 스크롤 가능한 고정 헤더
- **안내 문구**: 테이블 위에 "각 텍스트를 클릭하여 보임/숨김 처리할 수 있습니다" 문구 표시
- **ID 정렬 기능**: ID 열 헤더 클릭 시 정렬 순서 변경 (오름차순 ↑ → 내림차순 ↓ → 랜덤 ↕ → 오름차순 ↑)
- **재생 버튼**: 각 행에 재생 버튼(▶)이 있어 클릭 시 해당 단어의 발음 재생
- **텍스트 보임/숨김**: 각 텍스트(일본어 표기, 발음, 의미)를 클릭하여 개별 보임/숨김 처리 가능
- **컬럼 전체 보임/숨김**: 컬럼 헤더 클릭 시 해당 컬럼 전체 보임/숨김 처리

## 데이터 구조

### 단어셋 (WordSet)
```javascript
{
    "fileName": "page_01",  // 파일명 (고유 식별자)
    "words": [
        {
            "id": 1,                    // 단어 ID
            "japanese": "改札",         // 일본어 표기
            "pronunciation": "かいさつ", // 발음 (히라가나/가타카나)
            "meaning": "개찰"           // 한국어 의미
        },
        // ...
    ]
}
```

### 가중치 시스템
- **평가하기 모드**:
  - **키 형식**: `{fileName}_{wordId}_{questionType}` (예: `page_01_1_japanese`, `page_01_1_meaning`)
  - **값 범위**: 0 ~ 5 (기본값: 1)
  - **0의 의미**: 문제 완료 (선택 대상에서 제외)
- **공부하기 모드**:
  - **키 형식**: `{fileName}_{wordId}` (예: `page_01_1`)
  - **값 범위**: 1 ~ 5 (기본값: 1)
- **저장 위치**: 메모리 (세션 중에만 유지, 페이지 새로고침 시 초기화)

### 전역 변수
```javascript
let wordSets = [];           // 모든 단어셋 배열
let selectedWords = [];      // 선택된 단어들 (학습용)
let selectedQuestions = [];  // 평가하기 모드용 문제 배열
let currentWordIndex = -1;   // 현재 단어 인덱스
let wordHistory = [];        // 학습 히스토리 (스택 방식)
let currentQuestion = null;  // 현재 문제 정보
let answerShown = false;     // 정답 표시 여부
let weights = {};           // 가중치 객체
let studyMode = 'quiz';     // 'quiz' or 'study'
let buttonAlignment = 'center'; // 'left', 'center', 'right'
let jaVoice = null;         // Web Speech API 일본어 음성 객체
let longPressTimer = null;  // 긴 누름 타이머
let longPressCompleted = false; // 긴 누름이 완료되어 복사되었는지 여부
let clickTimer = null;     // 클릭 타이머
let idSortOrder = 'asc';   // 'asc', 'desc', 'random' - ID 정렬 순서
```

### 히스토리 구조 (스택 방식)
- **저장 방식**: 스택(LIFO) 방식으로 관리
- **저장 데이터**: 단어 객체 + 문제 유형 정보
  ```javascript
  {
      ...word,              // 원본 단어 데이터
      questionType: 'japanese' | 'meaning',  // 문제 유형
      questionLabel: '일본어 표기' | '뜻',    // 문제 라벨
      weightKey: 'page_01_1_japanese' | 'page_01_1_meaning'  // 문제별 가중치 키
  }
  ```
- **동작**: 이전으로 갔다가 다시 다음을 누르면 그 사이의 히스토리가 제거되고 새 문제 추가

## 데이터 저장 방식

### 메모리 기반 (세션 전용)
- **단어셋**: `wordSets` 배열에 저장 (페이지 로드 시 `results/` 폴더의 JSON 파일들을 동적으로 로드)
- **가중치**: `weights` 객체에 저장 (학습 시작 시 모든 단어의 가중치를 1로 초기화)
- **특징**: 페이지 새로고침 시 모든 데이터가 초기화됨

### 초기화 로직
1. 페이지 로드 시 `init()` 함수 실행:
   - `results/` 폴더에서 `page_01.json` ~ `page_29.json` 파일들을 fetch하여 로드
   - `loadWordSet(fileName)` 함수로 각 파일을 비동기적으로 로드
   - 로드 성공한 파일만 `wordSets` 배열에 추가
   - 파일이 없거나 로드 실패해도 오류 없이 동작
2. 학습 시작 시:
   - **평가하기 모드**: 각 단어에 대해 2개의 문제 생성 (일본어 표기, 의미), 각 문제의 가중치를 1로 초기화
   - **공부하기 모드**: 선택된 단어들의 가중치를 모두 1로 초기화
3. 세션 중에만 가중치가 업데이트됨 (페이지 새로고침 시 초기화)

## 주요 기능

### 1. 파일 관리
- **`handleFileUpload(event)`**: JSON 파일 업로드 및 파싱
  - 중복 파일명 체크 (덮어쓰기)
  - 메모리에만 저장 (세션 중에만 유지)
  
- **`renderFileList()`**: 파일 목록 렌더링
  - 숫자 기반 자연 정렬 (page_01, page_02, ...)
  - 단어 개수 표시
  - 체크박스 상태 관리

### 2. 모드 선택
- **`selectMode(mode)`**: 학습 모드 변경
  - `'quiz'`: 평가하기 (플래시카드)
  - `'study'`: 공부하기 (테이블)
  - 평가하기 모드 선택 시 문제 유형 선택 영역 표시
  - 공부하기 모드 선택 시 문제 유형 선택 영역 숨김 및 모든 체크박스 해제

### 3. 파일 선택
- **`toggleFileSelection(index, event)`**: 파일 선택 토글
  - 평가하기 모드: 다중 선택 가능
  - 공부하기 모드: 단일 선택만 가능
  
- **`selectAll()`**: 전체 선택 (평가하기 모드만)
- **`deselectAll()`**: 전체 해제

### 4. 학습 시작
- **`startStudy()`**: 학습 세션 시작
  - 선택된 단어들을 `selectedWords`에 병합
  - 각 단어에 `fileName`, `weightKey` 추가
  - **평가하기 모드**: 
    - 선택된 문제 유형 확인 (일본어 표기 문제, 의미 문제 체크박스)
    - 각 단어에 대해 선택된 문제 유형만 문제 생성
    - 각 문제를 `selectedQuestions` 배열에 추가
    - 각 문제의 가중치를 1로 초기화
  - **공부하기 모드**: 
    - 선택된 단어들의 가중치를 모두 1로 초기화
    - ID 정렬 순서를 'asc' (오름차순)로 초기화
  - 모드에 따라 다른 화면 표시
    - 평가하기: `flashcardScreen` (진행도 표시)
    - 공부하기: `studyTableScreen`

### 5. 가중치 기반 학습
- **`getWeightedRandomQuestion()`**: 가중치 기반 랜덤 문제 선택 (평가하기 모드)
  - 가중치가 1 이상인 문제만 선택 대상에 포함
  - 총 가중치 합 계산: `(문제의 가중치) / (가중치의 합)` 확률로 선택
  - 가중치가 높을수록 더 자주 출제
  - 모든 문제의 가중치가 0이면 `null` 반환 (완료)

- **`getWeightedRandomWord()`**: 가중치 기반 랜덤 단어 선택 (공부하기 모드)
  - 총 가중치 합 계산
  - 랜덤 값으로 가중치 구간 선택
  - 가중치가 높을수록 더 자주 출제

- **가중치 업데이트 규칙**:
  - **평가하기 모드**:
    - 정답 확인 후 다음: +1 (최대 5)
    - 정답 확인 없이 다음: -1 (최소 0, 가중치가 0이면 문제 완료로 간주)
    - 이전 버튼: 가중치 변화 없음
    - 이전에서 다음으로: 가중치 변화 없음
  - **공부하기 모드**:
    - 항상 +1 (최대 5)

### 6. 플래시카드 (평가하기 모드)
- **유한 문제 방식**: 각 단어에 대해 2개의 문제 생성 (일본어 표기, 의미)
  - 총 문제 수 = 선택된 단어 수 × 2
  - 각 문제는 독립적으로 가중치 관리
  
- **`nextCard()`**: 다음 카드 표시
  - 이전 문제 가중치 업데이트 (정답 확인 여부에 따라 +1/-1)
  - **스택 방식**: 현재 위치 이후의 히스토리 제거 (이전으로 갔다가 다시 다음을 누른 경우)
  - 새 문제 가중치 기반 선택 (`getWeightedRandomQuestion()`)
  - 모든 문제 완료 시 알람 없이 바로 처음 화면으로 이동
  - 진행도 업데이트
  
- **`previousCard()`**: 이전 카드로 이동
  - 히스토리 기반 네비게이션 (스택 방식)
  - 저장된 문제 유형 그대로 표시
  - 가중치 변화 없음
  
- **`displayCard()`**: 카드 내용 표시
  - 모드에 따라 다른 함수 호출
  - 진행도 업데이트
  
- **`displayQuizMode(word)`**: 평가 문제 표시
  - **문제 유형**: 일본어 표기, 뜻 (2가지만, 발음 문제는 제외)
    - 일본어 표기 → 발음/의미 맞추기
    - 뜻 → 일본어 표기/발음 맞추기
  - **히스토리 기반 문제 유형 사용**: 저장된 `questionType`이 있으면 사용, 없으면 랜덤 선택 후 저장
  - **카드 높이 유지**: 답 부분도 미리 렌더링하되 `hidden` 클래스로 숨김 처리 (공간은 유지)
  - **답 항목 순서**: 일본어 표기 → 뜻 → 발음 (발음이 가장 아래)
  - **발음 듣기 버튼**: 발음 항목 옆에 듣기 버튼(▶) 추가 (공부하기 모드와 동일한 스타일)
    - 발음이 있으면 발음 항목에 버튼 표시
    - 발음이 없으면 일본어 표기 항목에 버튼 표시
  - 정답 확인 버튼을 "?" 아이콘으로 초기화하고 항상 표시
  
- **`showAnswer()`**: 정답 표시/숨기기 토글
  - 정답이 숨겨져 있을 때: 정답 표시, 버튼 아이콘을 "✓"로 변경
  - 정답이 보여져 있을 때: 정답 숨김, 버튼 아이콘을 "?"로 변경
  - 버튼은 사라지지 않고 계속 표시됨 (토글 가능)
  - 가중치는 `nextCard()`에서만 변경
  
- **`updateProgress()`**: 진행도 업데이트
  - 가중치가 0이 된 문제 수 계산
  - 전체 문제 수 대비 완료된 문제 수 표시
  - "진행도: A / B" 형태로 좌측 상단에 표시
  
- **버튼 디자인**:
  - 모든 버튼이 동그라미 형태의 아이콘 버튼
  - 이전 버튼: ◀ (왼쪽 화살표)
  - 정답 확인 버튼: ? (물음표, 정답 표시 시 ✓)
  - 다음 버튼: ▶ (오른쪽 화살표)

### 7. 공부하기 모드
- **`displayStudyTable(wordSet)`**: 테이블 형태로 모든 단어 표시
  - ID, 재생, 일본어 표기, 발음, 의미 컬럼
  - 스크롤 가능한 고정 헤더
  - **안내 문구**: 테이블 위에 사용 안내 문구 표시
  - **ID 정렬**: `idSortOrder` 상태에 따라 단어 배열 정렬
    - `'asc'`: ID 오름차순 정렬
    - `'desc'`: ID 내림차순 정렬
    - `'random'`: Fisher-Yates 셔플 알고리즘으로 랜덤 정렬
  - **ID 헤더**: 클릭 가능하며 현재 정렬 상태를 아이콘으로 표시 (↑, ↓, ↕)
  - **재생 버튼**: 각 행에 재생 버튼(▶) 추가, 클릭 시 `playPronunciation()` 호출
  - **텍스트 보임/숨김**: 각 텍스트 셀에 `onclick="toggleCell(this)"` 추가
  - **컬럼 헤더 클릭**: 헤더에 `onclick="toggleColumn('columnType')"` 추가
  
- **`toggleIdSort()`**: ID 정렬 순서 변경
  - 정렬 순서 순환: `'asc'` → `'desc'` → `'random'` → `'asc'`
  - 정렬 순서 변경 후 테이블 자동 재렌더링
  
- **`toggleCell(cell)`**: 개별 셀 클릭 시 텍스트 보임/숨김 토글
  - `hidden-text` 클래스 토글
  - 가려진 텍스트는 배경색과 "•••" 표시로 구분
  
- **`toggleColumn(columnType)`**: 컬럼 헤더 클릭 시 해당 컬럼 전체 보임/숨김 토글
  - 모든 셀이 숨겨져 있으면 모두 보이게, 하나라도 보이면 모두 숨기기
  
- **`startLongPress(cell, text)`**: 긴 누름 시작 (클립보드 복사용)
  - 500ms 타이머 시작
  - 타이머 완료 시 `copyToClipboard()` 호출
  - 복사 완료 시 시각적 피드백 (배경색 변경)
  
- **`endLongPress()`**: 긴 누름 종료
  - 타이머가 실행 중이면 취소 (복사되지 않음)
  
- **`copyToClipboard(text)`**: 클립보드에 텍스트 복사
  - Clipboard API 사용 (최신 브라우저)
  - 구형 브라우저는 `document.execCommand('copy')` 사용
  - 복사 완료 시 피드백 메시지 표시
  
- **`showCopyFeedback(message, isError)`**: 복사 피드백 메시지 표시
  - 중앙에 "복사되었습니다!" 메시지 표시
  - 1.5초 후 자동 제거
  
- **`displayStudyMode(word)`**: 플래시카드 형태로 모든 정보 표시
  - 일본어 표기를 메인으로 표시
  - 발음, 의미 함께 표시

### 7-1. 발음 재생 기능 (Web Speech API)
- **`initVoices()`**: 페이지 로드 시 일본어 음성 초기화
  - Chrome 브라우저에서 "Google 日本語" 음성을 우선적으로 찾음
  - 없으면 다른 일본어 음성 사용
  - `speechSynthesis.onvoiceschanged` 이벤트로 음성 목록 업데이트 대기
  
- **`playPronunciation(text)`**: Web Speech API를 사용하여 발음 재생
  - 이전 발화 중단 (`speechSynthesis.cancel()`)
  - `SpeechSynthesisUtterance` 객체 생성
  - 언어 설정: `ja-JP`
  - 음성 선택: `jaVoice`가 있으면 사용 (Chrome의 Google 일본어 음성)
  - 속도: 0.9 (학습용으로 약간 느리게)
  - 피치: 1 (기본값)
  - 에러 처리: `utterance.onerror` 이벤트로 에러 로깅
  - **사용 위치**: 
    - 평가하기 모드: 답 공개 후 발음 듣기 버튼(▶) 클릭 시 호출
    - 공부하기 모드: 각 행의 재생 버튼(▶) 클릭 시 호출
  - **특징**:
    - 프록시 서버 불필요
    - API 키 불필요
    - Chrome에서 고품질 Google 일본어 음성 사용
    - 다른 브라우저에서는 OS 기본 일본어 음성 사용

### 8. 네비게이션
- **`goHome()`**: 처음 화면으로 돌아가기
  - 확인 다이얼로그
  - 모든 화면 숨김
  
- **`changeWordSet()`**: 단어셋 변경
  - 확인 다이얼로그
  - 파일 선택 화면으로 복귀

### 9. 버튼 정렬 설정
- **`toggleAlignmentMenu()`**: 정렬 메뉴 표시/숨김 토글
  - 설정 버튼 클릭 시 메뉴 표시/숨김
  
- **`setButtonAlignment(alignment)`**: 버튼 정렬 설정
  - `'left'`: 왼쪽 정렬
  - `'center'`: 중앙 정렬 (기본값)
  - `'right'`: 오른쪽 정렬
  - 선택한 옵션에 따라 `card-controls` 클래스 변경
  - 메뉴 외부 클릭 시 자동으로 닫힘

### 10. 유틸리티
- **`updateButtons()`**: 버튼 상태 업데이트 (이전 버튼 활성화/비활성화)
- **`updateProgress()`**: 진행도 업데이트 (평가하기 모드 전용)
  - 가중치가 0이 된 문제 수 계산
  - 전체 문제 수 대비 완료된 문제 수 표시
  - "진행도: A / B" 형태로 좌측 상단에 표시
- **`loadWordSet(fileName)`**: JSON 파일 로드 함수
  - `results/` 폴더에서 지정된 파일명의 JSON 파일을 fetch하여 로드
  - 파일이 없거나 로드 실패 시 `null` 반환
  - 에러 처리 포함
- **`init()`**: 페이지 로드 시 초기화 (async 함수)
  - `initVoices()` 호출하여 일본어 음성 초기화
  - `results/` 폴더에서 `page_01.json` ~ `page_29.json` 파일들을 동적으로 로드
  - `Promise.all`을 사용하여 병렬 로드
  - 로드 성공한 파일만 `wordSets` 배열에 추가
  - 파일 목록 렌더링

## CSS 구조

### 주요 스타일
- **그라데이션 배경**: 보라색 계열 (`#667eea` → `#764ba2`)
- **카드 디자인**: 둥근 모서리, 그림자 효과
- **반응형 디자인**: 
  - 모바일 (≤768px): 세로 레이아웃, 작은 폰트
  - 작은 모바일 (≤480px): 더 작은 폰트, 패딩 축소

### 주요 클래스
- `.container`: 메인 컨테이너 (최대 너비 600px)
- `.header`: 상단 헤더 (그라데이션 배경)
- `.card`: 플래시카드 컨테이너
- `.study-table`: 공부하기 테이블
- `.study-table-info`: 공부하기 테이블 위 안내 문구
- `.study-table .play-cell`: 재생 버튼 컬럼
- `.study-table .play-button`: 재생 버튼 (미니멀 스타일, ▶ 아이콘)
- `.pronunciation-play-button`: 평가하기 모드의 발음 듣기 버튼 (공부하기 모드와 동일한 스타일)
- `.study-table th.id-cell`: ID 헤더 (클릭 가능, 호버 효과, 정렬 아이콘 표시)
- `.study-table .japanese-cell`, `.study-table .pronunciation-cell`, `.study-table .meaning-cell`: 클릭 가능한 텍스트 셀
- `.study-table .hidden-text`: 가려진 텍스트 (배경색 변경, "•••" 표시)
- `.question-type-selection`: 문제 유형 선택 영역 (평가하기 모드만 표시)
- `.hidden`: 숨김 처리 (display: none)
- `.card-answer.hidden`: 답 영역 숨김 처리 (공간은 유지, visibility: hidden 사용)
- `.progress-badge`: 진행도 배지 (좌측 상단, 보라색 계열)
- `.weight-badge`: 가중치 배지 (우측 상단, 보라색 계열)
- `.btn-primary`, `.btn-secondary`: 버튼 스타일
- `.btn-icon`: 동그라미 아이콘 버튼 (이전: ◀, 정답 확인: ?, 다음: ▶)
- `.card-controls.align-left`, `.card-controls.align-center`, `.card-controls.align-right`: 버튼 정렬 클래스
- `.settings-button`: 설정 버튼 (카드 왼쪽 상단)
- `.alignment-menu`: 버튼 정렬 선택 메뉴

## 학습 흐름

### 평가하기 모드 (유한 문제 방식)
1. **문제 유형 선택**: 일본어 표기 문제와 의미 문제를 체크박스로 선택 (기본값: 둘 다 선택)
2. 파일 선택 (다중 선택 가능)
3. 학습 시작
4. 선택된 문제 유형에 따라 각 단어에 대해 문제 생성 (일본어 표기, 의미)
5. 각 문제의 가중치를 1로 초기화
6. 가중치 기반 확률로 문제 선택: `(문제의 가중치) / (가중치의 합)`
7. 문제 표시 (문제 객체를 히스토리에 저장)
8. 정답 확인 또는 바로 넘어가기
9. **발음 듣기**: 답 공개 후 발음 항목 옆의 듣기 버튼(▶) 클릭 시 발음 재생
10. 가중치 업데이트:
    - 정답 확인 후 다음: +1 (최대 5)
    - 정답 확인 없이 다음: -1 (최소 0, 가중치가 0이면 문제 완료)
11. 진행도 업데이트 (가중치가 0이 된 문제 수 / 전체 문제 수)
12. 다음 문제 선택 (6번으로)
13. **이전 버튼**: 저장된 문제 유형 그대로 표시, 가중치 변화 없음 (스택 방식)
14. **이전으로 갔다가 다시 다음**: 그 사이의 히스토리 제거 후 새 문제 추가, 가중치 변화 없음
15. **완료**: 모든 문제의 가중치가 0이 되면 알람 없이 바로 처음 화면으로 이동

### 공부하기 모드
1. 파일 선택 (단일 선택만 가능)
2. 학습 시작 (ID 정렬 순서는 오름차순으로 초기화)
3. 테이블 형태로 모든 단어 표시 (안내 문구 포함, 기본적으로 ID 오름차순)
4. ID 열 헤더 클릭하여 정렬 순서 변경 (오름차순 ↑ → 내림차순 ↓ → 랜덤 ↕ → 오름차순 ↑)
5. 재생 버튼(▶) 클릭 시 해당 단어의 발음 재생
6. 각 텍스트(일본어 표기, 발음, 의미) 클릭하여 개별 보임/숨김 처리
7. 컬럼 헤더 클릭하여 해당 컬럼 전체 보임/숨김 처리
8. 각 칸을 길게 누르면(500ms 이상) 해당 내용이 클립보드에 자동 복사
9. 스크롤하여 전체 단어 확인

## 특징 및 제약사항

### 특징
- ✅ 가중치 기반 반복 학습 (SRS 유사, 세션 중에만 유지)
- ✅ 두 가지 학습 모드 제공
- ✅ **유한 문제 방식** (평가하기 모드): 각 단어당 2문제 생성, 총 문제 수 = 단어 수 × 2
- ✅ 반응형 디자인 (모바일 최적화)
- ✅ **기본 단어셋 동적 로드**: `results/` 폴더의 JSON 파일들을 페이지 로드 시 자동으로 fetch하여 로드
- ✅ JSON 파일 업로드 지원
- ✅ 간단한 구조 (영구 저장 없음)
- ✅ 카드 높이 일정 유지 (정답 확인 전후 동일한 높이)
- ✅ 정답 확인/숨기기 토글 기능 (버튼을 여러 번 클릭하여 정답 표시/숨김 가능)
- ✅ 동그라미 아이콘 버튼 디자인 (이전: ◀, 정답 확인: ?/✓, 다음: ▶)
- ✅ 버튼 정렬 선택 기능 (왼쪽/중앙/오른쪽 정렬 선택 가능)
- ✅ 스택 방식 히스토리 관리 (이전으로 갔다가 다시 다음을 누르면 그 사이 히스토리 제거)
- ✅ 문제 유형 히스토리 저장 (이전 버튼 클릭 시 같은 문제 유형 표시)
- ✅ **진행도 표시**: 좌측 상단에 "진행도: A / B" 형태로 표시 (A = 완료된 문제 수, B = 전체 문제 수)
- ✅ **완료 시 자동 이동**: 모든 문제 완료 시 알람 없이 바로 처음 화면으로 이동
- ✅ **발음 재생 기능**: Web Speech API로 발음 재생 (Chrome에서 Google 일본어 음성 사용)
  - 평가하기 모드: 답 공개 후 발음 듣기 버튼(▶) 제공
  - 공부하기 모드: 각 행의 재생 버튼(▶)으로 발음 재생
- ✅ **문제 유형 선택**: 평가하기 모드에서 일본어 표기 문제와 의미 문제를 선택적으로 출제 가능
- ✅ **ID 정렬 기능**: 공부하기 모드에서 ID 열 헤더 클릭 시 정렬 순서 변경 (오름차순 → 내림차순 → 랜덤 → 오름차순)
- ✅ **텍스트 보임/숨김 기능**: 공부하기 모드에서 각 텍스트(일본어 표기, 발음, 의미)를 클릭하여 개별 보임/숨김 처리 가능
- ✅ **컬럼 전체 보임/숨김**: 공부하기 모드에서 컬럼 헤더 클릭 시 해당 컬럼 전체 보임/숨김 처리
- ✅ **가려진 텍스트 표시**: 가려진 텍스트는 배경색과 "•••" 표시로 정보가 있음을 알 수 있음
- ✅ **클립보드 복사 기능**: 공부하기 모드에서 각 칸을 길게 누르면(500ms 이상) 클립보드에 자동 복사

### 제약사항
- ⚠️ 단일 HTML 파일 구조 (코드 분리 없음)
- ⚠️ 서버 없이 동작 (클라이언트 사이드만)
- ⚠️ 가중치 범위: 평가하기 모드는 0~5, 공부하기 모드는 1~5 (고정)
- ⚠️ 공부하기 모드는 단일 파일만 선택 가능
- ⚠️ 발음 문제 유형 제외 (일본어 표기, 뜻 문제만 출제)
- ⚠️ 평가하기 모드는 유한 문제 방식 (각 단어당 2문제)
- ⚠️ 페이지 새로고침 시 모든 학습 데이터 초기화 (가중치, 히스토리 등)

## 확장 가능성

### 개선 가능한 영역
1. **가중치 시스템**: 범위 확장, 감쇠율 조정
2. **통계 기능**: 학습 진행률, 정답률 추적 (세션 중)
3. **필터링**: 가중치별, 파일별 필터
4. **검색 기능**: 단어 검색
5. **데이터 영구 저장**: LocalStorage 또는 IndexedDB 추가 (선택적)
6. **다크 모드**: 테마 전환
7. **애니메이션**: 카드 플립 효과
8. **오디오 재생**: 발음 듣기 기능 ✅ (Web Speech API로 구현 완료)

## 코드 품질

### 장점
- ✅ 명확한 함수 분리
- ✅ 주석이 적절히 포함
- ✅ 반응형 디자인 구현
- ✅ 에러 처리 (파일 업로드)

### 개선 필요
- ⚠️ 전역 변수 다수 사용
- ⚠️ 이벤트 핸들러 인라인 사용
- ⚠️ 매직 넘버 (가중치 최대값 5, 파일 개수 29)
- ⚠️ 데이터 영구 저장 없음 (세션 종료 시 모든 데이터 손실)

## 데이터 흐름

```
초기화 (init - async)
  ↓
results/ 폴더에서 JSON 파일들 fetch (page_01.json ~ page_29.json)
  ↓
로드 성공한 파일들을 wordSets에 추가
  ↓
파일 목록 렌더링 (renderFileList)
  ↓
[사용자 액션]
  ↓
파일 선택 → 학습 시작 (startStudy)
  ↓
[평가하기 모드]
  - 각 단어에 대해 2개의 문제 생성 (일본어 표기, 의미)
  - 각 문제의 가중치를 1로 초기화
  - selectedQuestions 배열에 저장
  ↓
[공부하기 모드]
  - 가중치 초기화 (모든 단어를 1로 설정)
  - 테이블 표시 (안내 문구 포함)
  ↓
화면 전환
  ↓
[평가하기] 
  - 가중치 기반 확률로 문제 선택: (문제의 가중치) / (가중치의 합)
  - 문제 객체를 히스토리에 저장 (스택 방식)
  - 문제 표시 → 정답 확인 → 가중치 업데이트 (메모리)
  - 진행도 업데이트 (가중치가 0이 된 문제 수 / 전체 문제 수)
  - 이전 버튼: 저장된 문제 유형 그대로 표시, 가중치 변화 없음
  - 이전으로 갔다가 다시 다음: 그 사이 히스토리 제거 후 새 문제 추가, 가중치 변화 없음
  - 모든 문제 완료 시 알람 없이 바로 처음 화면으로 이동
  ↓
[공부하기] 
  - ID 정렬 순서 초기화 (오름차순)
  - 테이블 표시 (재생 버튼 포함, ID 오름차순 정렬)
  - ID 헤더 클릭 시 정렬 순서 변경 (toggleIdSort)
  - 텍스트 클릭 시 보임/숨김 토글 (toggleCell)
  - 컬럼 헤더 클릭 시 컬럼 전체 보임/숨김 토글 (toggleColumn)
  - 재생 버튼 클릭 시 발음 재생 (playPronunciation)
  ↓
[페이지 새로고침 시 모든 데이터 초기화]
```

## 보안 고려사항
- JSON 파싱 시 에러 처리 필요 (현재 구현됨)
- XSS 방지를 위해 사용자 입력 검증 필요 (현재는 파일 업로드만)
- 데이터가 메모리에만 저장되므로 페이지 종료 시 자동 삭제

## 브라우저 호환성
- ES6+ 문법 사용 (async/await, 화살표 함수 등)
- 모던 브라우저 권장 (Chrome, Firefox, Safari, Edge)
- LocalStorage 불필요 (메모리 기반만 사용)
- **Web Speech API**: 발음 재생 기능 사용
  - Chrome: "Google 日本語" 고품질 음성 사용 (클라우드 기반, 인터넷 연결 필요)
  - Firefox/Safari: OS 기본 일본어 음성 사용 (로컬 TTS 엔진)
  - Edge: Chrome과 유사하게 Google 음성 사용 가능

